import{r,j as e}from"./react-vendor-DlAMHaFI.js";import{m as F,n as J,E as U,o as v,p as k,V as o,u as A,q as G,r as B,s as N,t as C,v as O,w as V,x as g,y as z,z as q,A as K,G as H,J as Q}from"./three-bundle-DVfC6CUv.js";import"./vendor-CXo-eD7O.js";import"./physics-bundle-CmnDU9Yz.js";const X="/assets/card.glb",Y="/assets/lanyard.png";K({MeshLineGeometry:Q,MeshLineMaterial:H});function re({position:f=[0,0,30],gravity:j=[0,-40,0],fov:m=20,transparent:h=!0,cameraDistance:w=19,onInteract:l}){const[s,i]=r.useState(()=>typeof window<"u"&&window.innerWidth<768);r.useEffect(()=>{const t=()=>i(window.innerWidth<768);return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]);const u=[f[0],f[1],w];return e.jsx("div",{className:"relative z-0 w-full h-screen flex justify-center items-center transform scale-100 origin-center",children:e.jsxs(F,{camera:{position:u,fov:m},dpr:[1,s?1.5:2],gl:{alpha:h},onCreated:({gl:t})=>t.setClearColor(new k(0),h?0:1),children:[e.jsx("ambientLight",{intensity:Math.PI}),e.jsx(J,{gravity:j,timeStep:s?1/30:1/60,children:e.jsx(Z,{isMobile:s,onInteract:l})}),e.jsxs(U,{blur:.75,children:[e.jsx(v,{intensity:2,color:"white",position:[0,-1,5],rotation:[0,0,Math.PI/3],scale:[100,.1,1]}),e.jsx(v,{intensity:3,color:"white",position:[-1,-1,1],rotation:[0,0,Math.PI/3],scale:[100,.1,1]}),e.jsx(v,{intensity:3,color:"white",position:[1,1,1],rotation:[0,0,Math.PI/3],scale:[100,.1,1]}),e.jsx(v,{intensity:10,color:"white",position:[-10,0,14],rotation:[0,Math.PI/2,Math.PI/3],scale:[100,10,1]})]})]})})}function Z({maxSpeed:f=50,minSpeed:j=0,isMobile:m=!1,onInteract:h}){const w=r.useRef(null),l=r.useRef(null),s=r.useRef(null),i=r.useRef(null),u=r.useRef(null),t=r.useRef(null),p=new o,P=new o,E=new o,L=new o,y={type:"dynamic",canSleep:!0,colliders:!1,angularDamping:4,linearDamping:4},{nodes:b,materials:M}=A(X),R=G(Y),x=G("/assets/card-texture.png");r.useEffect(()=>{x&&(x.wrapS=B,x.repeat.x=-1,x.needsUpdate=!0)},[x]);const[d]=r.useState(()=>new N([new o,new o,new o,new o])),[c,S]=r.useState(!1),[T,I]=r.useState(!1);return C(l,s,[[0,0,0],[0,0,0],1]),C(s,i,[[0,0,0],[0,0,0],1]),C(i,u,[[0,0,0],[0,0,0],1]),O(u,t,[[0,0,0],[0,1.45,0]]),r.useEffect(()=>{if(T)return document.body.style.cursor=c?"grabbing":"grab",()=>{document.body.style.cursor="auto"}},[T,c]),V((n,D)=>{c&&typeof c!="boolean"&&(p.set(n.pointer.x,n.pointer.y,.5).unproject(n.camera),L.copy(p).sub(n.camera.position).normalize(),p.add(L.multiplyScalar(n.camera.position.length())),[t,s,i,u,l].forEach(a=>a.current?.wakeUp()),t.current?.setNextKinematicTranslation({x:p.x-c.x,y:p.y-c.y,z:p.z-c.z})),l.current&&([s,i].forEach(a=>{a.current.lerped||(a.current.lerped=new o().copy(a.current.translation()));const W=Math.max(.1,Math.min(1,a.current.lerped.distanceTo(a.current.translation())));a.current.lerped.lerp(a.current.translation(),D*(j+W*(f-j)))}),d.points[0].copy(u.current.translation()),d.points[1].copy(i.current.lerped),d.points[2].copy(s.current.lerped),d.points[3].copy(l.current.translation()),w.current.geometry.setPoints(d.getPoints(m?16:32)),P.copy(t.current.angvel()),E.copy(t.current.rotation()),t.current.setAngvel({x:P.x,y:P.y-E.y*.25,z:P.z}))}),d.curveType="chordal",R.wrapS=R.wrapT=B,e.jsxs(e.Fragment,{children:[e.jsxs("group",{position:[0,4,0],children:[e.jsx(g,{ref:l,...y,type:"fixed"}),e.jsx(g,{position:[.5,0,0],ref:s,...y,children:e.jsx(z,{args:[.1]})}),e.jsx(g,{position:[1,0,0],ref:i,...y,children:e.jsx(z,{args:[.1]})}),e.jsx(g,{position:[1.5,0,0],ref:u,...y,children:e.jsx(z,{args:[.1]})}),e.jsxs(g,{position:[2,0,0],ref:t,...y,type:c?"kinematicPosition":"dynamic",children:[e.jsx(q,{args:[.8,1.125,.01]}),e.jsxs("group",{scale:2.25,position:[0,-1.2,-.05],onPointerOver:()=>I(!0),onPointerOut:()=>I(!1),onPointerUp:n=>{n.target.releasePointerCapture(n.pointerId),S(!1)},onPointerDown:n=>{n.target.setPointerCapture(n.pointerId),S(new o().copy(n.point).sub(p.copy(t.current.translation()))),h&&h()},children:[e.jsx("mesh",{geometry:b.card.geometry,children:e.jsx("meshPhysicalMaterial",{map:M.base.map,"map-anisotropy":16,clearcoat:m?0:1,clearcoatRoughness:.15,roughness:.3,metalness:.8})}),e.jsx("mesh",{geometry:b.clip.geometry,material:M.metal,"material-roughness":.3}),e.jsx("mesh",{geometry:b.clamp.geometry,material:M.metal})]})]})]}),e.jsxs("mesh",{ref:w,children:[e.jsx("meshLineGeometry",{}),e.jsx("meshLineMaterial",{color:"white",depthTest:!1,resolution:m?[1e3,2e3]:[1e3,1e3],useMap:!0,map:R,repeat:[-4,1],lineWidth:1})]})]})}export{re as default};
